from scapy.all import *
import json

def restorearp(targetip, targetmac, sourceip, sourcemac):
	packet= ARP(op=2 , hwsrc=sourcemac , psrc=sourceip, hwdst= targetmac , pdst= targetip)
	send(packet, verbose=False)
	print("ARP Table restored to normal for", targetip)

with open('ips.json') as json_file:
	data = json.load(json_file)
	restorearp(data['targetip'], data['targetmac'], data['gatewayip'], data['gatewaymac'])
	restorearp(data['gatewayip'], data['gatewaymac'], data['targetip'], data['targetmac'])